#
# uptime
#
# a psend packet definition file to get the
# uptime of a host using SNMP v2c (which is coded
# version byte value 1)
#

# the IP address of the SNMP enabled device being queried
host 10.7.0.12

# use SNMP port 161
port 161

# construct the packet `back to front`
prepend

# null
0x05 0

# OID   1.3.6.1.2.1.1.3.0
0x06 8 0x2B 6 1 2 1 1 3 0

# variable binding sequence
length-1byte
0x30

# variable binding overall sequence
length-1byte
0x30

# error offset (0 for a GET request SNMP packet)
0x02 1  0

# error code (0 for a GET request SNMP packet)
0x02 1  0

# 4 byte packet identifier (any 4 byte values will do)
0x02 4  0xDEADBEEF

# SNMP GET request PDU (Protocol Data Unit)
length-1byte
0xA0

# read community string
0x04 6 'blipuc'

# SNMP version (0=Version 1, 1=Version 2c, 2=Version 3)
0x02 1 1

# final encapsulating sequence
length-1byte
0x30

# show the packet
show

# send the packet
send

# wait for and display any response
receive

# end of file 'uptime.txt'
